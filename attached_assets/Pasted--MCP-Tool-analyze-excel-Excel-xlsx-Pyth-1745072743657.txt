×œ×”×œ×Ÿ ×”×¦×¢×” ×œÖ¾MCP Tool ×—×“×©, analyze_excel, ×©×××¤×©×¨ ×œ×”×¢×œ×•×ª ×§×•×‘×¥ Excel (.xlsx) ×•×œ× ×ª×—×• ××•×˜×•××˜×™×ª ×‘×¢×–×¨×ª Python/Pandas ×‘×¨×§×¢, ×•×œ××—×¨ ××›×Ÿ ×œ×”×—×–×™×¨ ×ª×•×‘× ×•×ª ××•×‘× ×•×ª ×“×¨×š ×”×¦×³××˜:

×ª×§×¦×™×¨
×”×›×œ×™ analyze_excel ×™×§×‘×œ ××™×§×•× ×©×œ ×§×•×‘×¥ Excel, ×™×©××•×¨ ××•×ª×• ×–×× ×™×ª, ×™×¤×¢×™×œ ×ª×¡×¨×™×˜ Python ×©××™×™×‘× ××ª ×”×§×•×‘×¥ ×¢× pandas.read_excel ×•××—×©×‘ ×¡×˜×˜×™×¡×˜×™×§×•×ª ×ª×™××•×¨×™×•×ª (DataFrame.describe), ×”×¢×¨×›×ª ×—×¡×¨×™× (DataFrame.isna), ×¡×•×’×™ ×¢××•×“×•×ª ×•×”×¤×§×ª ×¡×›×•××™ ×‘×™× ×™×™×; ×œ×‘×¡×•×£ ×™×—×–×™×¨ ×˜×§×¡×˜ ××¡×•×›× ×”×›×•×œ×œ: ×›×œ ×¢××•×“×”, ×¡×•×’ ×”× ×ª×•× ×™× ×©×œ×”, ××¡×¤×¨ ×¢×¨×›×™× ×—×¡×¨×™×, ×•×¨×•×‘×“×™× ×¡×˜×˜×™×¡×˜×™×™× (×××•×¦×¢, ×—×¦×™×•×Ÿ, ××™× ×™××•×, ××§×¡×™××•×)  ï¿¼ ï¿¼ ï¿¼. ×›×š ×”××•×“×œ ×œ× â€œ×××¦×™×â€ ×××¦××™× ××œ× ××¤×¢×™×œ ×›×œ×™ ×§×•× ×§×¨×˜×™.

â¸»

## ×ª×™××•×¨ ×”×›×œ×™: analyze_excel
	â€¢	×©× ×”×›×œ×™: analyze_excel
	â€¢	×§×œ×˜:

{
  "file_path": "string"  // × ×ª×™×‘ ××•×—×œ×˜/×™×—×¡×™ ×œ×§×•×‘×¥ Excel .xlsx
}

××™××•×ª ×”×¡×›××” ×¢× Zod ×©×œ ×¤×¨××˜×¨ ××—×“ ××¡×•×’ ××—×¨×•×–×ª  ï¿¼.

	â€¢	×¤×œ×˜:

{
  "content": [
    { "type":"text", "text": "Column 'Age' (int): 0 missing, mean=29.3, median=28, min=18, max=65" },
    { "type":"text", "text": "Column 'Name' (object): 2 missing, top values: Alice(3), Bob(2)" },
    â€¦
  ]
}

â€” ×©×•×¨×•×ª ×˜×§×¡×˜ ××•×‘× ×•×ª ×œ×›×œ ×¢××•×“×”.

â¸»

## ××™××•×© ×‘Ö¾server.js

#!/usr/bin/env node
import { McpServer } from '@modelcontextprotocol/sdk/server/mcp.js';
import { StdioServerTransport } from '@modelcontextprotocol/sdk/server/stdio.js';
import { z } from 'zod';
import { spawn } from 'child_process';
import path from 'path';

async function main() {
  const server = new McpServer({ name: 'AnalyzerServer', version: '1.0.0' });

  server.tool(
    'analyze_excel',
    { file_path: z.string() },
    async ({ file_path }) => {
      // 1) ××¨×™×¦×™× ××ª ×”×ª×¡×¨×™×˜ Python ×œ× ×™×ª×•×—
      const scriptPath = path.join(__dirname, 'analyze_excel.py');
      const py = spawn('python3', [scriptPath, file_path], { stdio: ['ignore','pipe','inherit'] });  //  [oai_citation_attribution:4â€¡Stack Overflow](https://stackoverflow.com/questions/34213845/call-python-script-using-node-js-child-process?utm_source=chatgpt.com)

      // 2) ×§×•×¨××™× stdout ×©×œ ×”×ª×¡×¨×™×˜
      let output = '';
      for await (const chunk of py.stdout) {
        output += chunk.toString('utf8');
      }
      // 3) ××¤×¦×œ×™× ×œ×¤×™ ×©×•×¨×” ×•××—×–×™×¨×™× ×‘×ª×‘× ×™×ª MCP
      const lines = output.trim().split('\n');
      return {
        content: lines.map(line => ({ type: 'text', text: line }))
      };
    }
  );

  const transport = new StdioServerTransport();
  await server.connect(transport);
  console.log('ğŸ”§ AnalyzerServer on STDIO: analyze_excel');
}

main().catch(err => {
  console.error(err);
  process.exit(1);
});

	â€¢	×›××Ÿ ××©×ª××©×™× ×‘Ö¾child_process.spawn ×›×“×™ ×œ×”×¤×¢×™×œ Python ×‘××¡×™× ×›×¨×•× ×™ ×‘×œ×™ ×œ×—×¡×•× ××ª ×”×œ×•×œ××” ×©×œ Node.js  ï¿¼.
	â€¢	×”×ª×¡×¨×™×˜ analyze_excel.py ××§×‘×œ argv[1] ×›× ×ª×™×‘ ×œ×§×•×‘×¥.

â¸»

## ×ª×¡×¨×™×˜ Python: analyze_excel.py

#!/usr/bin/env python3
import sys
import pandas as pd

def summarize(df):
    summaries = []
    for col in df.columns:
        series = df[col]
        dtype = series.dtype
        missing = int(series.isna().sum())  #  [oai_citation_attribution:6â€¡pandas.pydata.org](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isna.html?utm_source=chatgpt.com)
        if pd.api.types.is_numeric_dtype(series):
            desc = series.describe()           #  [oai_citation_attribution:7â€¡pandas.pydata.org](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.describe.html?utm_source=chatgpt.com)
            summaries.append(
                f"Column '{col}' ({dtype}): {missing} missing, "
                f"mean={desc['mean']:.2f}, median={desc['50%']}, "
                f"min={desc['min']}, max={desc['max']}"
            )
        else:
            top = series.value_counts().head(3).to_dict()
            top_str = ', '.join(f"{k}({v})" for k,v in top.items())
            summaries.append(
                f"Column '{col}' ({dtype}): {missing} missing, top: {top_str}"
            )
    return summaries

if __name__ == "__main__":
    path = sys.argv[1]
    df = pd.read_excel(path, sheet_name=0)  #  [oai_citation_attribution:8â€¡pandas.pydata.org](https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html?utm_source=chatgpt.com)
    for line in summarize(df):
        print(line)

	â€¢	pandas.read_excel ×ª×•××š ×‘Ö¾.xlsx ×•×§×•×¨× ×’×™×œ×™×•×Ÿ ××—×“ ×›×‘×¨×™×¨×ª ××—×“×œ  ï¿¼.
	â€¢	DataFrame.describe() ××¡×¤×§ ×¡×˜×˜×™×¡×˜×™×§×•×ª ×ª×™××•×¨×™×•×ª: count, mean, std, min/max, percentiles  ï¿¼.
	â€¢	Series.isna() ××’×œ×” ×¢×¨×›×™× ×—×¡×¨×™× ×‘×§×œ×•×ª  ï¿¼.

â¸»

## ×©×™×œ×•×‘ ×‘Ö¾Client (Express + Gemini)

×œ× × ×“×¨×© ×©×™× ×•×™ ××™×•×—×“ ×‘Ö¾client.js, ×›×™ ×”Ö¾MCP Client ×›×‘×¨ ××•×©×š ××ª ×›×œ ×”×›×œ×™× ×‘Ö¾listTools() ×•Ö¾×”××•×“×œ â€œ×™×›×™×¨â€ ××•×˜×•××˜×™×ª ××ª analyze_excel. ×œ×“×•×’××”:

User: ×× ×œ×– ×§×•×‘×¥ data.xlsx
Assistant â†’ function_call: { name: "analyze_excel", arguments: { file_path: "/tmp/data.xlsx" } }
Assistant â†’ ×ª×•×¦××”:  
 Column 'Age' (int64): 0 missing, mean=29.30, median=28.0, min=18.0, max=65.0  
 Column 'Name' (object): 2 missing, top: Alice(3), Bob(2), Eve(1)



â¸»

## ×§×™×©×•×¨×™× ×œ×œ××™×“×” × ×•×¡×¤×ª
	â€¢	pandas.read_excel â€“ ×§×¨×™××ª Excel ×œâ€‘DataFrame  ï¿¼ ï¿¼
	â€¢	pandas.DataFrame.describe â€“ ×¡×˜×˜×™×¡×˜×™×§×•×ª ×ª×™××•×¨×™×•×ª  ï¿¼ ï¿¼
	â€¢	pandas.DataFrame.isna â€“ ×–×™×”×•×™ ×¢×¨×›×™× ×—×¡×¨×™×  ï¿¼
	â€¢	Node.js child_process.spawn â€“ ×”×¨×¦×ª Python ××ª×”×œ×™×›×™× ×©×œ Node.js  ï¿¼ ï¿¼
	â€¢	Zod â€“ ××™××•×ª ×¤×¨××˜×¨×™× ×‘×¡×›××” ×‘Ö¾Node.js  ï¿¼

â¸»

×‘×××¦×¢×•×ª ×”×›×œ×™ analyze_excel ××ª×” ××§×‘×œ ××™× ×˜×’×¨×¦×™×” ××œ××” ×©×œ Excel analysis ×¢×œ ×‘×¡×™×¡ Python/Pandas ×‘×ª×•×š ××¨×›×™×˜×§×˜×•×¨×ª MCP, ×•×”Ö¾LLM â€œ××—×™×™×‘â€ ×©×™××•×© ×‘×›×œ×™ ×××™×ª×™ ×‘××§×•× ×œ×”××¦×™× ×ª×•×‘× ×•×ª.